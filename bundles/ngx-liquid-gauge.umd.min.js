!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("d3")):"function"==typeof define&&define.amd?define("ngx-liquid-gauge",["exports","@angular/core","d3"],e):e(t["ngx-liquid-gauge"]={},t.ng.core,t.d3)}(this,function(t,e,D){"use strict";var a=function(){function t(){}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var i=function(){function t(){this.id="gauge"+Math.floor(1e5*Math.random())+1,this.defaultSettings={minValue:0,maxValue:100,circleThickness:.05,circleFillGap:.05,circleColor:"#178BCA",waveHeight:.05,waveCount:1,waveRiseTime:1e3,waveAnimateTime:18e3,waveRise:!0,waveHeightScaling:!0,waveAnimate:!0,waveColor:"#178BCA",waveOffset:0,textVertPosition:.5,textSize:1,valueCountUp:!0,displayPercent:!0,textColor:"#045681",waveTextColor:"#A4DBf8"},this.value=0,this.minValue=this.defaultSettings.minValue,this.maxValue=this.defaultSettings.maxValue,this.circleThickness=this.defaultSettings.circleThickness,this.circleFillGap=this.defaultSettings.circleFillGap,this.circleColor=this.defaultSettings.circleColor,this.waveHeight=this.defaultSettings.waveHeight,this.waveCount=this.defaultSettings.waveCount,this.waveRiseTime=this.defaultSettings.waveRiseTime,this.waveAnimateTime=this.defaultSettings.waveAnimateTime,this.waveRise=this.defaultSettings.waveRise,this.waveHeightScaling=this.defaultSettings.waveHeightScaling,this.waveAnimate=this.defaultSettings.waveAnimate,this.waveColor=this.defaultSettings.waveColor,this.waveOffset=this.defaultSettings.waveOffset,this.textVertPosition=this.defaultSettings.textVertPosition,this.textSize=this.defaultSettings.textSize,this.valueCountUp=this.defaultSettings.valueCountUp,this.displayPercent=this.defaultSettings.displayPercent,this.textColor=this.defaultSettings.textColor,this.waveTextColor=this.defaultSettings.waveTextColor}return t.prototype.ngOnInit=function(){this.createChart()},t.prototype.ngOnChanges=function(t){this.createChart()},t.prototype.createChart=function(){var t=this.gauge.nativeElement;D.select(t).selectAll("*").remove(),D.select(t).append("svg").attr("id",this.id).attr("width","150").attr("height","150");var e={minValue:this.minValue,maxValue:this.maxValue,circleThickness:this.circleThickness,circleFillGap:this.circleFillGap,circleColor:this.circleColor,waveHeight:this.waveHeight,waveCount:this.waveCount,waveRiseTime:this.waveRiseTime,waveAnimateTime:this.waveAnimateTime,waveRise:this.waveRise,waveHeightScaling:this.waveHeightScaling,waveAnimate:this.waveAnimate,waveColor:this.waveColor,waveOffset:this.waveOffset,textVertPosition:this.textVertPosition,textSize:this.textSize,valueCountUp:this.valueCountUp,displayPercent:this.displayPercent,textColor:this.textColor,waveTextColor:this.waveTextColor};!function j(t,l,u){null==u&&(u={minValue:0,maxValue:100,circleThickness:.05,circleFillGap:.05,circleColor:"#178BCA",waveHeight:.05,waveCount:1,waveRiseTime:1e3,waveAnimateTime:18e3,waveRise:!0,waveHeightScaling:!0,waveAnimate:!0,waveColor:"#178BCA",waveOffset:0,textVertPosition:.5,textSize:1,valueCountUp:!0,displayPercent:!0,textColor:"#045681",waveTextColor:"#A4DBf8"});var c,e=D.select("#"+t),a=Math.min(parseInt(e.style("width"),10),parseInt(e.style("height"),10))/2,i=parseInt(e.style("width"),10)/2-a,n=parseInt(e.style("height"),10)/2-a,h=Math.max(u.minValue,Math.min(u.maxValue,l))/u.maxValue;c=u.waveHeightScaling?D.scaleLinear().range([0,u.waveHeight,0]).domain([0,50,100]):D.scaleLinear().range([u.waveHeight,u.waveHeight]).domain([0,100]);var r=u.textSize*a/2,s=parseFloat(l).toFixed(2),o=u.valueCountUp?u.minValue:s,p=u.displayPercent?"%":"",v=u.circleThickness*a,d=v+u.circleFillGap*a,f=a-d,w=f*c(100*h),m=2*f/u.waveCount,g=1+u.waveCount,x=m*g,y=function(t){return""+Math.round(t)};parseFloat(s)!==parseFloat(y(s))&&(y=function(t){return parseFloat(t).toFixed(1)}),parseFloat(s)!==parseFloat(y(s))&&(y=function(t){return parseFloat(t).toFixed(2)});for(var C=[],T=0;T<=40*g;T++)C.push({x:T/(40*g),y:T/40});D.scaleLinear().range([0,2*Math.PI]).domain([0,1]),D.scaleLinear().range([0,a]).domain([0,a]);var I=D.scaleLinear().range([0,x]).domain([0,1]),S=D.scaleLinear().range([0,w]).domain([0,1]),F=D.scaleLinear().range([d+2*f+w,d-w]).domain([0,1]),V=D.scaleLinear().range([0,x-2*f]).domain([0,1]),A=D.scaleLinear().range([d+2*f,d+.7*r]).domain([0,1]),P=e.append("g").attr("transform","translate("+i+","+n+")"),R=[{x:0,y:0},{x:0,y:parseInt(e.style("height"))},{x:parseInt(e.style("width"),10),y:parseInt(e.style("height"))},{x:parseInt(e.style("width"),10),y:0},{x:0,y:0}],M=D.line().x(function(t){return t.x}).y(function(t){return t.y});P.append("path").attr("d",M(R)).attr("stroke",u.circleColor).attr("stroke-width",v).attr("fill","none");var H=P.append("text").text(y(o)+p).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",r+"px").style("fill",u.textColor).attr("transform","translate("+a+","+A(u.textVertPosition)+")"),L=D.area().x(function(t){return I(t.x)}).y0(function(t){return S(Math.sin(2*Math.PI*u.waveOffset*-1+2*Math.PI*(1-u.waveCount)+2*t.y*Math.PI))}).y1(function(t){return 2*f+w}),G=P.append("defs").append("clipPath").attr("id","clipWave"+t),O=G.append("path").datum(C).attr("d",L).attr("T",0),k=P.append("g").attr("clip-path","url(#clipWave"+t+")");k.append("rect").attr("x",a-f).attr("y",a-f).attr("width",2*f).attr("height",2*f).style("fill",u.waveColor);var q=k.append("text").text(y(o)+p).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",r+"px").style("fill",u.waveTextColor).attr("transform","translate("+a+","+A(u.textVertPosition)+")");if(u.valueCountUp){var z=function(){var e=this,a=D.interpolate(this.textContent,s);return function(t){e.textContent=y(a(t))+p}};H.transition().duration(u.waveRiseTime).tween("text",z),q.transition().duration(u.waveRiseTime).tween("text",z)}var U=d+2*f-x;function b(t){O.attr("transform","translate("+V(+O.attr("T"))+",0)"),O.transition().duration(u.waveAnimateTime*(1-+O.attr("T"))).ease(D.easeLinear).attr("transform","translate("+V(1)+",0)").attr("T",1).on("end",function(){O.attr("T",0),b(u.waveAnimateTime)})}return u.waveRise?G.attr("transform","translate("+U+","+F(0)+")").transition().duration(u.waveRiseTime).attr("transform","translate("+U+","+F(h)+")").on("start",function(){O.attr("transform","translate(1,0)")}):G.attr("transform","translate("+U+","+F(h)+")"),u.waveAnimate&&b(),new function B(){this.update=function(t){var a=this,e=parseFloat(t).toFixed(2),i=function(t){return""+Math.round(t)};parseFloat(e)!==parseFloat(i(e))&&(i=function(t){return parseFloat(t).toFixed(1)}),parseFloat(e)!==parseFloat(i(e))&&(i=function(t){return parseFloat(t).toFixed(2)});var n=function(){var e=D.interpolate(a.textContent,parseFloat(l).toFixed(2));return function(t){this.textContent=i(e(t))+p}};H.transition().duration(u.waveRiseTime).tween("text",n),q.transition().duration(u.waveRiseTime).tween("text",n),h=Math.max(u.minValue,Math.min(u.maxValue,l))/u.maxValue,w=f*c(100*h);var r,s=(F=D.scaleLinear().range([d+2*f+w,d-w]).domain([0,1]))(h);I=D.scaleLinear().range([0,x]).domain([0,1]),S=D.scaleLinear().range([0,w]).domain([0,1]),r=u.waveHeightScaling?D.area().x(function(t){return I(t.x)}).y0(function(t){return S(Math.sin(2*Math.PI*u.waveOffset*-1+2*Math.PI*(1-u.waveCount)+2*t.y*Math.PI))}).y1(function(t){return 2*f+w}):L;var o=u.waveAnimate?V(1):0;O.transition().duration(0).transition().duration(u.waveAnimate?u.waveAnimateTime*(1-+O.attr("T")):u.waveRiseTime).ease(D.easeLinear).attr("d",r).attr("transform","translate("+o+",0)").attr("T","1").on("start",function(){u.waveAnimate&&(O.attr("transform","translate("+V(0)+",0)"),b(u.waveAnimateTime))}),G.transition().duration(u.waveRiseTime).attr("transform","translate("+U+","+s+")")}}}(this.id,this.value,e)},t.decorators=[{type:e.Component,args:[{selector:"lib-ngx-liquid-gauge",template:"<div #gauge></div>"}]}],t.ctorParameters=function(){return[]},t.propDecorators={gauge:[{type:e.ViewChild,args:["gauge"]}],value:[{type:e.Input}],minValue:[{type:e.Input}],maxValue:[{type:e.Input}],circleThickness:[{type:e.Input}],circleFillGap:[{type:e.Input}],circleColor:[{type:e.Input}],waveHeight:[{type:e.Input}],waveCount:[{type:e.Input}],waveRiseTime:[{type:e.Input}],waveAnimateTime:[{type:e.Input}],waveRise:[{type:e.Input}],waveHeightScaling:[{type:e.Input}],waveAnimate:[{type:e.Input}],waveColor:[{type:e.Input}],waveOffset:[{type:e.Input}],textVertPosition:[{type:e.Input}],textSize:[{type:e.Input}],valueCountUp:[{type:e.Input}],displayPercent:[{type:e.Input}],textColor:[{type:e.Input}],waveTextColor:[{type:e.Input}]},t}(),n=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[],declarations:[i],exports:[i]}]}],t}();t.NgxLiquidGaugeService=a,t.NgxLiquidGaugeComponent=i,t.NgxLiquidGaugeModule=n,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-liquid-gauge.umd.min.js.map